Todo:
- Cursor change to pointing index thingy
- Color blue only on link
- Hover tooltip
- Identify links better
- Underline links
- Unhovered link color
- Hovered link color
- Visited link color (pressed status)

v2:
- Blue link unhovered: RGB(51,102,204)
- On hover: underline and tooltip
- On visit: purple, fix later...

v3:
- Use some library to get urls properly... there may be .net, .org. etc.

v4:
- Almost everything done! 
- Add Ctrl+A to clear current typed message? No, because Ctrl+X already does that
- Maybe add player icon in front of chat; as a config option on/off
- Make icon, mb similar to this? Made a bad scrapped one in Old folder. https://steamcommunity.com/sharedfiles/filedetails/?id=2566083800&searchtext=chat+improver
- Make hover better (Main.hover... instead of UICommon)
- Improve hover to match tooltip and hover color change!
- Investigate underline thing out of focus

Config options:
- Format links (meaning make them blue, underlined, hoverable.)
- Link tooltip: "none, light, descriptive"
- Show player icons
- Scroll chat messages
- Left right input

v5:
- Implement the stuff in config
- Improve hover link
- Fix link underline
- Make player choose their own color
- Scroll with mousewheel
- Left right arrows to insert characters ins type stuff
- Ctrl+shift+leftarrow to mark words?
- BetterChat color thing but better?

v6:
- [CONTINUE] Change box color
- [x] Change box position
- [x] Change max number of shown messages
- [x] Change time until message disappear
- [NO] Add scrollwheel like UIScrollbar? Nahh
- [x-ish] Add scale to chat box (added scale to text but didnt rly help)
- [x] Add scale to messages
- [NO] Add favorited messages? That saves as a .json for the player ID, like little notes?
- [CONTINUE] Add emojis to chat (icon button ON the chat box, to the left)
- [CONTINUE] Add images to chat (icon button ON the chat box, to the left to take screenshot and send.)
- [CONTINUE] Add padding between messages
- [x] Fix so player icon only shows up for PLAYER messages, not all messages
- [NO] Adding themes like DPSPanel to chat box? NO! Resource packs do this

v7:
- Add box color (easy)
- Add text color (easy)
- Add timestamp to messages (easy)
- Add padding between messages AND scale. Config option: Scale Low, Medium, High.

- Add emojis 
- Add screenshots

- Add REBIND chat

- Add left right arrows to navigate input box
- Add mouse scroll
- Add scrollbar

- Bug: Resizing window removes the formatting! (kinda low priority)

Idea:
- Add draggable chat box?

v8:
https://steamcommunity.com/sharedfiles/filedetails/?id=3448785552 adds icons, timestamps,etc. also typing indicators. also check out global chat.
- who used boss summon 

Name ideas:
"Advanced Chat Features"
"x Chat?"

v9:
- See trello.

v10:

Current features:
- Player colors and formatting
- Links in chat

Autocomplete:
- Initially create a list once on world load of all "CommandEntry" entries in the game. This is a struct from IChatCommand and ModCommand that includes: 
  - Icon [Texture2D] (terraria: tree icon, tmodloader: tmodicon). shows name of mod on hover
  - Name [string]. (the command name, e.g. "/help")
  - Description [string] (shown on hover)
- Fuzzy search to find closest matches to the input text will create a blue highlight ghost text that will be shown in the input box.
- Pressing enter will always send the current message, including the blue highlight ghost text. 
(This may be hard, since we have to artificially append the ghost text to the end of the input box before sending it.)
- Pressing tab will autocomplete the ghost text into the input box, replacing the current text.
- Pressing up and down arrows will cycle through the autocomplete suggestions, updating the current text. But the current text should still be able to be edited freely (dont update the text every tick).

Optional:
- Dynamically expand width of window based on biggest entry visible.
- Add filter icon for mod filtering
- Add filter icon for client, server, commands (ChatCommandId)
- Copy visual studio autocomplete UI: Window, scrollable, etc.

Steps to develop:
1. Create a window with sample commands. 
Sorting: Alphabetically by command name.
Scrolling: Up and down arrows to navigate through the list.
MouseHover: Highlight the command entry when hovered with the mouse.
MouseClick: Enter the command into the input box, replacing the current text.
Enter: Send the current message, including the ghost text.
Escape: Remove the ghost text and close the autocomplete window.

2. Fuzzy autocomplete:
Filter: When Main.chatText is updated, update the list of commands to only include those that match the current input text.
Ghost text: Create a ghost text that shows the closest match to the current input text.
Tab: Enter the ghost text into the input box.

3. Config:
Enable/disable autocomplete.
Enable/disable draggable autocomplete window.

Config v2:
- Items visible (3-20)
- Show tooltips
- Show hover tooltips
- 
- Scroll speed

Preview images on steam workshop later:
1. Autocomplete commands!
2. Send links in chat!
3. Customize your chat! (show colors and player icons)
4. Send emojis!

Todo:
- Input caret left right arrow keys always working
- ItemSystem with [i , open up item browser
- ColorSystem with [c , open up color picker, live color preview?
- Upload image with [s, open up file upload]
- Animated emojis?!
- Add mod icons, exactly like player icons
- Add steam profile icons?
- Hover player icon gives preview of player

Cleanup:
- Autocomplete and ghost text for all
- Usage panels for all
- More abstraction
- Sync player icons to multiplayer
- Sync player colors to multiplayer and allow choosing your own

Steam Workshop Preview:
1. Emojis, Links, Images! (showing 3 chat messages of each feature)
2. Autocomplete commands and tags! (opening command and tag window)
3. Keyboard shortcuts and text editing! (showing text editing)

2025-08-17
----------------------------------------------------------------
Refactor State Handling, Filtering, Tab:

Todo:
✅ Up down arrow keys - navigate through items
✅ Prefix checking - open or close states
✅ Tab input - add tag to chat input
✅. Key input - filter items

Future:
✅. Left click - select item and add tag to chat input
5. Escape input - close the active panel
2025-08-19
--------------------------------------------------------------------------------------------------------------------------------
[DONE]Bug: Ensure compat with ChitterChatter (meaning, ensure AddNewMessage hook still gets called by hooking that mod's AddNewMessage hook. Not done yet.)
[SCRATCHED] 2. Feat: Add escape key press to exit a state.
[SCRATCHED] 3. Feat: Add enter key press to input the selected item and close the state.
[SCRATCHED] Feat: More colors!
[DONE] Bug: Ensure compat with ChatImprover (meaning, if that mod is enabled, disable our text editor since user probably wants that mods text editor instead).
[DONE] Config elements preview
2025-08-22
[DONE] Automatically upload a bigger image e.g always resize to a height of 300px and fit aspect ratio.
[DONE] Automatically resize draw chat height and move chat monitor lines.
[DONE] Automatically add spacer snippets to fit the size.

Workshop images. Make sure they have the same format, zoom, resolution, text size/font, etc.
1. Share emojis!
2. Share images!
3. Autocomplete!
4. Text editor!
---
[done] Fix uploads not saving (UploadInitializer)
[done] Fix image size (UploadTagHandler, HandleChat "\n"). Force same height every time.
[DONE!!!] Fix image size compat for chitterchatter

[todo low prio] Move image chat pos to below the playername 
[nice to have low prio] Fix cursor position of colors (HandleChat)
[nice to have low prio] more colors
[nice to have low prio] "header texts" for colors, emojis, glyphs, items, modicons, uploads.
[nice to have low prio] better esc and enter handling
[nice to have low prio] match new lines to image height
[nice to have low prio] sync all autocomplete windows pos and save it
---
Systems:
1. CommandSystem: prefix: "/"
2. ColorSystem: prefix "[c"
3. EmojiSystem: prefix: "[e"
4. GlyphSystem: prefix: "[g"
5. ItemSystem: prefix: "[i". 
6. ModIconSystem: prefix: "[mi" 
6. UploadSystem: . prefix: "[u"
---
Fix unintended description panel overlapping for long text descriptions in CommandPanel
Fix so multiple systems cannot be open simultaneously, because rn it is causing confusion and unintended bugs
Fix so pressing enter on a command enters it into chat
---
2025-08-27:
Add mod icons
Add player icons
Add scrollbar
---
Scrollbar functionality:
- Works to drag the handle
- Works to scroll with up down arrow keys
- Works to scroll with mouse wheel
